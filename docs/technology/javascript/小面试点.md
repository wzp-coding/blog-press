---
title: 小面试点
---

# 一些简单但你也必须懂的基础

## Object.create
作用：Object.create可以用来创建一个纯净的空对象,这个对象没有原型,如`Object.create(null)`

原理：实际上是创建一个空对象，将空对象的__proto__指向第一个参数
```js
// 比如Object.create(null)的实现
const obj = {}
obj.__proto__ = null
```

## new原理
new的过程其实不复杂，直接看MDN上的描述

> new 关键字会进行如下的操作：
>
> 1. 创建一个空的简单JavaScript对象（即{}）；
> 2. 为步骤1新创建的对象添加属性__proto__，将该属性链接至构造函数的原型对象 ；
> 3. 将步骤1新创建的对象作为this的上下文 ；
> 4. 如果该函数没有返回对象，则返回this。

```js
const _new = function (fn, ...args) {
    /* 第一步相当于
    const obj = {}
    obj.__proto__ = fn.prototype
    */
    const obj = Object.create(fn.prototype);
    const ret = fn.apply(obj, args);
    return ret instanceof Object ? ret : obj;
}
```






## import.meta

import.meta对象由一个关键字"import",一个点符号和一个meta属性名组成。通常情况下"import."是作为一个属性访问的上下文，但是在这里"import"不是一个真正的对象。

import.meta对象是由ECMAScript实现的，它带有一个null的原型对象。这个对象可以扩展，并且它的属性都是可写，可配置和可枚举的。



## sort

`sort()` 方法用[原地算法](https://en.wikipedia.org/wiki/In-place_algorithm)对数组的元素进行排序，并返回数组。

默认排序顺序是在将元素转换为字符串，然后比较它们的UTF-16代码单元值序列时构建的

由于它取决于具体实现，因此无法保证排序的时间和空间复杂性。

> 在计算机科学中，原地算法是一种不使用辅助数据结构转换输入的算法。但是，允许为辅助变量提供少量额外的存储空间。当算法执行时，输入通常被输出覆盖。原地算法只通过替换或者交换元素来更新它的输入序列。没有就位的算法有时被称为不就位或不就位。



## reduce

### 作用

`reduce()` 方法对数组中的每个元素执行一个由您提供的**reducer**函数(升序执行)，将其结果汇总为单个返回值。

### 语法

> `arr.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue])`

### 参数

- `callback`

  执行数组中每个值 (如果没有提供 `initialValue则第一个值除外`)的函数，包含四个参数：

  1. **`accumulator`**

     ​	累计器累计回调的返回值; 它是上一次调用回调时返回的累积值，或`initialValue`（见于下方）。

  2. `currentValue`

     ​	数组中正在处理的元素。

  3. `index` 可选

     ​	数组中正在处理的当前元素的索引。 如果提供了`initialValue`，则起始索引号为0，否则从索引1起始。

  4. `array`可选

     ​	调用`reduce()`的数组

- `initialValue`可选

  ​	作为第一次调用 `callback`函数时的第一个参数的值。 如果没有提供初始值，则将使用数组中的第一个元素。 在没有初始值的空数组上调用 reduce 将报错。

### 返回值

函数累计处理的结果

### 描述

`reduce`为数组中的每一个元素依次执行`callback`函数，不包括数组中被删除或从未被赋值的元素，接受四个参数：

- `accumulator 累计器`
- `currentValue 当前值`
- `currentIndex 当前索引`
- `array 数组`

回调函数第一次执行时，`accumulator` 和`currentValue`的取值有两种情况：

- 如果调用`reduce()`时提供了`initialValue`，`accumulator`取值为`initialValue`，`currentValue`取数组中的第一个值；
- 如果没有提供 `initialValue`，那么`accumulator`取数组中的第一个值，`currentValue`取数组中的第二个值。

**注意：**

- 如果没有提供`initialValue`，reduce 会从索引1的地方开始执行 callback 方法，跳过第一个索引。

- 如果提供`initialValue`，从索引0开始。

- 如果数组为空且没有提供`initialValue`，会抛出[`TypeError`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/TypeError)（无论位置如何）并且没有提供`initialValue`， 或者有提供`initialValue`但是数组为空，那么此唯一值将被返回并且`callback`不会被执行。

### 手写

```js
Array.prototype._reduce = function (callback, initialValue) {
  let first = true;
  let array = this;
  let accumulator, currentValue, index;
  if (array.length === 0 && initialValue === void 0) {
    // 数组为空且没有提供initialValue，会抛出TypeError
    throw new Error("TypeError");
  }
  if (array.length === 1 && initialValue === void 0) {
    // 数组仅有一个元素（无论位置如何）并且没有提供initialValue
    return array[0];
  }
  if (array.length === 0 && initialValue !== void 0) {
    // 有提供initialValue但是数组为空
    return initialValue;
  }
  return (() => {
    for (let i = 0, j = array.length; i < j; i++) {
      if (first) {
        // 第一次执行
        first = false;
        if (initialValue !== void 0) {
          // 如果调用reduce()时提供了initialValue，accumulator取值为initialValue，currentValue取数组中的第一个值
          accumulator = initialValue;
          currentValue = array[0];
          // 如果提供initialValue，从索引0开始。
          // 注意：下一次索引应该是array[1]
          index = 0;
        } else {
          // 如果没有提供 initialValue，那么accumulator取数组中的第一个值，currentValue取数组中的第二个值
          accumulator = array[0];
          currentValue = array[1];
          // 如果没有提供initialValue，reduce 会从索引1的地方开始执行 callback 方法，跳过第一个索引
          // 注意：下一次索引应该是array[2]
          index = 1;
          i += 1;
        }
      } else {
        currentValue = array[i];
        index = i;
      }
      accumulator = callback(accumulator, currentValue, index, array);
    }
    return accumulator;
  })();
};
```



## indexOf

`indexOf()`方法返回在数组中可以找到一个给定元素的第一个索引，如果不存在，则返回-1。

## 参考
> [Object.create()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create)
>
> [new 运算符](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new)
>
> [import.meta](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import.meta)
>
> [sort](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/sort)
>
> [indexOf](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)
>
> [Reduce](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)

